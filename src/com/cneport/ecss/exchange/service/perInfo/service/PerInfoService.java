package com.cneport.ecss.exchange.service.perInfo.service;import java.util.Map;import org.apache.axis2.saaj.util.IDGenerator;import org.apache.poi.ss.usermodel.Row;import org.apache.poi.ss.usermodel.Sheet;import org.springframework.stereotype.Service;import org.springframework.transaction.annotation.Transactional;import com.cneport.ecss.exchange.common.ExcelUtil;import com.cneport.ecss.exchange.service.perInfo.entity.PerInfoHead;import com.cneport.ecss.exchange.service.perInfo.persistence.PerInfoMapper;@Servicepublic class PerInfoService {    // @Autowired    private PerInfoMapper perInfoMapper;    @Transactional    public void impPerInfo(Sheet sheet, Map<String, String> map)	    throws Exception {	sheet = ExcelUtil.cellTypeTOString(sheet);	for (int rowNum = 1; rowNum <= sheet.getLastRowNum(); rowNum++) {	    String uuid = IDGenerator.generateID();	    int countHead = 0;	    String IdNumber = "";	    Row row = sheet.getRow(rowNum);	    if (rowNum >= 1) {		PerInfoHead perInfo = new PerInfoHead();		perInfo.setHPersonalName(ExcelUtil.replaceValue(row.getCell(0),			60, "姓名", map));		perInfo.setHIdNumber(ExcelUtil.replaceValue(row.getCell(1), 60,			"身份证号", map));		perInfo.setHMobile(ExcelUtil.replaceValue(row.getCell(2), 18,			"绑定手机号", map));		perInfo.setHBankId(ExcelUtil.replaceValue(row.getCell(3), 24,			"本人银联卡号", map));		perInfo.setHAddress(ExcelUtil.replaceValue(row.getCell(4), 250,			"常用收货地址", map));		perInfo.setHEmail(ExcelUtil.replaceValue(row.getCell(5), 250,			"电子邮箱", map));		if (ExcelUtil.rowIsNull(perInfo)) {		    return;		}		perInfo.setSeqNo(uuid);		IdNumber = ExcelUtil.replaceValue(row.getCell(1));		if (!"".equals(IdNumber)) {		    countHead = this.perInfoMapper.countPerInfo(IdNumber);		}		if (countHead <= 0) {		    this.perInfoMapper.insertPerInfo(perInfo);		}	    }	}    }}